# 红黑树

## 二查搜索树的缺陷
***

若是插入的数据是下面这样的情况：

<img src="../img/BST_disadvantage.png" alt="">

非平衡树：

* 好的二叉搜索树数据是**左右分布均匀的**

* 插入连续数据后，分布的不均匀，这种树叫做**非平衡树**；

* 对平衡二叉树，插入查找的效率为O(logN)；而对非平衡二叉树，极端情况下就变成了链表，效率就变成了O(N)。



## 树的平衡性
***

为了以较快的速度O(logN)来操作一棵树，我们需要保证树总是平衡的；

* 树越平衡，它的时间复杂度越接近与O(logN)

* 树中每个**节点左边的子孙节点**尽可能与**节点右边的子孙节点**数量相同

* 平衡树的两种：AVL树和红黑树；

## 红黑树的特性

性质1. 节点是红色或黑色；

性质2. 根节点是黑色；

性质3. 叶子节点都是黑色的空节点（NIL节点）；

性质4. 每个红色节点的两个子节点都是黑色的；（不能有红色连续节点）

性质5. 从任一节点到其每个叶子的所有路径都包含相同数目的黑色节点。

<img src = '../img/RBT.png'>

 前面的特性，保证了红黑树：

* 从根到叶子的**最长可能路径，不会超过最短可能路径的两倍**。

* 因为性质4使得最长路径是红黑交替，最短是都是黑色节点，而性质5所有路径都包含相同数目的黑色节点。

## 树的变换方式

插入一个新节点，有可能树不平衡，可以通过三种变换，让树保持平衡：

换色；左旋转；右旋转

1. 变色：
    
    * 插入新节点都是**红色**

    * 若插入的是黑色节点，那么或导致路径上多了黑色节点，很难调整；

    * 红红相连时，也可通过颜色调换和旋转来调整

2. 旋转：

<img src = '../img/RBT_leftrotate.png'>
<img src = '../img/RBT_rightrotate.png'>

## 红黑树插入操作
新节点：N       父节点：P       祖父节点：G     兄弟节点:U

* 情况一: N插入到根上
    
    解决方法： N  红 —> 黑

* 情况二: P,U均为红色
    
    解决方法：第一步： P,U 红 -> 黑 G 黑-> 红；第二步 ：递归往上变换

* 情况三: P为黑色
    
    解决方法： 无需变换

* 情况四:  P红U黑 N为左子节点
    
    解决方法： 第一步：P -> 黑 G -> 红 ；第二步：右旋转

* 情况五: P红U黑 N为左子节点
    
    解决方法： 第一步：以P为根左旋；第二步：重复情况四的操作

